{% extends "base.html" %}
{% block content %}
<div class="container my-5">

  <!-- Card principal -->
  <div class="card shadow-sm border-0 rounded-3">
    <div class="card-body">

      <!-- Header -->
      <div class="mb-4">
        <h2 class="h3 fw-bold mb-1">➕ Nuevo Honorario</h2>
        <p class="text-muted mb-0">Completa los datos para registrar un nuevo honorario contable</p>
      </div>

      <!-- Formulario -->
      <form method="post" class="row g-3">
        {% csrf_token %}

        <!-- Cliente -->
        <div class="col-md-6">
          <label for="{{ form.cliente.id_for_label }}" class="form-label fw-semibold">Cliente</label>
          {{ form.cliente }}
          {% for error in form.cliente.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- Concepto -->
        <div class="col-md-6">
          <label for="{{ form.concepto.id_for_label }}" class="form-label fw-semibold">Concepto</label>
          {{ form.concepto }}
          {% for error in form.concepto.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- Monto -->
        <div class="col-md-6">
          <label for="{{ form.monto.id_for_label }}" class="form-label fw-semibold">Monto</label>
          {{ form.monto }}
          {% for error in form.monto.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- Modalidad -->
        <div class="col-md-6">
          <label for="{{ form.modalidad.id_for_label }}" class="form-label fw-semibold">Modalidad</label>
          {{ form.modalidad }}
          {% for error in form.modalidad.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- Meses de Crédito (solo si modalidad = CRED) -->
        <div class="col-md-6" id="div_meses" style="display:none;">
          <label for="{{ form.meses_credito.id_for_label }}" class="form-label fw-semibold">Meses de Crédito</label>
          {{ form.meses_credito }}
          {% for error in form.meses_credito.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- Periodo -->
        <div class="col-md-6">
          <label for="{{ form.periodo.id_for_label }}" class="form-label fw-semibold">Periodo</label>
          {{ form.periodo }}
          {% for error in form.periodo.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- Botones -->
        <div class="col-12 d-flex justify-content-start mt-3">
          <button type="submit" class="btn btn-success me-2">
            <i class="bi bi-save"></i> Guardar
          </button>
          <a href="{% url 'contable:carga_honorarios' %}" class="btn btn-outline-secondary">
            <i class="bi bi-x-circle"></i> Cancelar
          </a>
        </div>

      </form>

    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const modalidad = document.getElementById('{{ form.modalidad.id_for_label }}');
    const divMeses = document.getElementById('div_meses');
    const mesesInput = document.getElementById('{{ form.meses_credito.id_for_label }}');

    function toggleMeses() {
        if (modalidad.value === 'CRED') {  // valor exacto de tu opción de crédito
            divMeses.style.display = 'block';
        } else {
            divMeses.style.display = 'none';
            mesesInput.value = '';
        }
    }

    modalidad.addEventListener('change', toggleMeses);
    toggleMeses();  // para mostrar/ocultar al cargar la página según valor inicial
});
</script>
{% endblock %}
